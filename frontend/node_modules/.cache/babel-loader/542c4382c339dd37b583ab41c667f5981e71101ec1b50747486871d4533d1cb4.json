{"ast":null,"code":"var _jsxFileName = \"/Users/utsavaggarwal/Documents/NutriDive/frontend/src/components/BarcodeScanner.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Camera, X, Upload, RefreshCw, StopCircle, Play } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { toast } from \"sonner\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function BarcodeScanner({\n  onScan,\n  onClose\n}) {\n  _s();\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [isScanning, setIsScanning] = useState(false);\n  const [stream, setStream] = useState(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const animationRef = useRef(null);\n  const detectorRef = useRef(null);\n\n  // Initialize barcode detector\n  useEffect(() => {\n    if ('BarcodeDetector' in window) {\n      detectorRef.current = new window.BarcodeDetector({\n        formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e', 'code_128', 'code_39', 'qr_code', 'itf']\n      });\n    }\n  }, []);\n\n  // Start camera\n  const startCamera = useCallback(async () => {\n    try {\n      setHasError(false);\n      setErrorMessage(\"\");\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: {\n            ideal: \"environment\"\n          },\n          width: {\n            ideal: 1280\n          },\n          height: {\n            ideal: 720\n          }\n        }\n      });\n      setStream(mediaStream);\n      if (videoRef.current) {\n        videoRef.current.srcObject = mediaStream;\n        videoRef.current.onloadedmetadata = () => {\n          videoRef.current.play();\n          setIsScanning(true);\n          startScanning();\n        };\n      }\n    } catch (err) {\n      console.error(\"Camera error:\", err);\n      setHasError(true);\n      if (err.name === \"NotAllowedError\") {\n        setErrorMessage(\"Camera access was denied. Please allow camera permissions in your browser settings.\");\n      } else if (err.name === \"NotFoundError\") {\n        setErrorMessage(\"No camera found on this device.\");\n      } else {\n        setErrorMessage(err.message || \"Could not access camera\");\n      }\n    }\n  }, []);\n\n  // Scan for barcodes\n  const startScanning = useCallback(() => {\n    if (!detectorRef.current) {\n      // Fallback message if BarcodeDetector not supported\n      toast.info(\"Live scanning not supported. Please upload a barcode image.\");\n      return;\n    }\n    const scanFrame = async () => {\n      if (!videoRef.current || !isScanning) return;\n      try {\n        const barcodes = await detectorRef.current.detect(videoRef.current);\n        if (barcodes.length > 0) {\n          const barcode = barcodes[0].rawValue;\n          toast.success(`Barcode detected: ${barcode}`);\n          stopCamera();\n          onScan(barcode);\n          return;\n        }\n      } catch (err) {\n        // Ignore detection errors, continue scanning\n      }\n      animationRef.current = requestAnimationFrame(scanFrame);\n    };\n    scanFrame();\n  }, [isScanning, onScan]);\n\n  // Stop camera\n  const stopCamera = useCallback(() => {\n    setIsScanning(false);\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n    }\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n  }, [stream]);\n\n  // Handle close\n  const handleClose = () => {\n    stopCamera();\n    onClose();\n  };\n\n  // Handle file upload\n  const handleFileUpload = async e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n    try {\n      const img = new Image();\n      img.src = URL.createObjectURL(file);\n      await new Promise((resolve, reject) => {\n        img.onload = resolve;\n        img.onerror = reject;\n      });\n      if ('BarcodeDetector' in window) {\n        const detector = new window.BarcodeDetector({\n          formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e', 'code_128', 'code_39', 'qr_code', 'itf']\n        });\n        const barcodes = await detector.detect(img);\n        if (barcodes.length > 0) {\n          toast.success(`Barcode detected: ${barcodes[0].rawValue}`);\n          handleClose();\n          onScan(barcodes[0].rawValue);\n          return;\n        }\n      }\n      toast.error(\"Could not detect barcode in image. Please try a clearer image or enter manually.\");\n    } catch (error) {\n      console.error(\"File scan error:\", error);\n      toast.error(\"Failed to scan image. Please try again.\");\n    }\n\n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  // Start camera on mount\n  useEffect(() => {\n    startCamera();\n    return () => stopCamera();\n  }, []);\n\n  // Restart scanning when isScanning changes\n  useEffect(() => {\n    if (isScanning && detectorRef.current) {\n      startScanning();\n    }\n  }, [isScanning, startScanning]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 z-50 bg-black/95 flex items-center justify-center p-4 animate-fade-in\",\n    \"x-file-name\": \"BarcodeScanner\",\n    \"x-line-number\": \"172\",\n    \"x-component\": \"div\",\n    \"x-id\": \"BarcodeScanner_172\",\n    \"x-dynamic\": \"false\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative w-full max-w-lg\",\n      \"x-file-name\": \"BarcodeScanner\",\n      \"x-line-number\": \"173\",\n      \"x-component\": \"div\",\n      \"x-id\": \"BarcodeScanner_173\",\n      \"x-dynamic\": \"false\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"ghost\",\n        size: \"icon\",\n        className: \"absolute -top-12 right-0 text-white hover:bg-white/20 transition-all\",\n        onClick: handleClose,\n        \"data-testid\": \"close-scanner\",\n        \"x-file-name\": \"BarcodeScanner\",\n        \"x-line-number\": \"175\",\n        \"x-component\": \"Button\",\n        \"x-id\": \"BarcodeScanner_175\",\n        \"x-dynamic\": \"true\",\n        children: /*#__PURE__*/_jsxDEV(X, {\n          className: \"h-6 w-6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-background rounded-2xl overflow-hidden shadow-2xl border border-border/50\",\n        \"x-file-name\": \"BarcodeScanner\",\n        \"x-line-number\": \"185\",\n        \"x-component\": \"div\",\n        \"x-id\": \"BarcodeScanner_185\",\n        \"x-dynamic\": \"false\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 border-b bg-gradient-to-r from-primary/10 to-secondary/10\",\n          \"x-file-name\": \"BarcodeScanner\",\n          \"x-line-number\": \"187\",\n          \"x-component\": \"div\",\n          \"x-id\": \"BarcodeScanner_187\",\n          \"x-dynamic\": \"false\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-heading font-semibold flex items-center gap-2\",\n            \"x-file-name\": \"BarcodeScanner\",\n            \"x-line-number\": \"188\",\n            \"x-component\": \"h3\",\n            \"x-id\": \"BarcodeScanner_188\",\n            \"x-dynamic\": \"false\",\n            children: [/*#__PURE__*/_jsxDEV(Camera, {\n              className: \"h-5 w-5 text-primary\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"189\",\n              \"x-component\": \"Camera\",\n              \"x-id\": \"BarcodeScanner_189\",\n              \"x-dynamic\": \"false\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this), \"Scan Barcode\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-muted-foreground mt-1\",\n            \"x-file-name\": \"BarcodeScanner\",\n            \"x-line-number\": \"192\",\n            \"x-component\": \"p\",\n            \"x-id\": \"BarcodeScanner_192\",\n            \"x-dynamic\": \"false\",\n            children: \"Point your camera at the barcode or upload an image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative aspect-video bg-black overflow-hidden\",\n          \"x-file-name\": \"BarcodeScanner\",\n          \"x-line-number\": \"198\",\n          \"x-component\": \"div\",\n          \"x-id\": \"BarcodeScanner_198\",\n          \"x-dynamic\": \"true\",\n          children: hasError ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-gray-900 to-black text-white p-6 text-center\",\n            \"x-file-name\": \"BarcodeScanner\",\n            \"x-line-number\": \"200\",\n            \"x-component\": \"div\",\n            \"x-id\": \"BarcodeScanner_200\",\n            \"x-dynamic\": \"false\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mb-4\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"201\",\n              \"x-component\": \"div\",\n              \"x-id\": \"BarcodeScanner_201\",\n              \"x-dynamic\": \"false\",\n              children: /*#__PURE__*/_jsxDEV(Camera, {\n                className: \"h-10 w-10 text-red-400\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"202\",\n                \"x-component\": \"Camera\",\n                \"x-id\": \"BarcodeScanner_202\",\n                \"x-dynamic\": \"false\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium mb-2\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"204\",\n              \"x-component\": \"p\",\n              \"x-id\": \"BarcodeScanner_204\",\n              \"x-dynamic\": \"false\",\n              children: \"Camera Access Required\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-400 mb-6 max-w-xs\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"205\",\n              \"x-component\": \"p\",\n              \"x-id\": \"BarcodeScanner_205\",\n              \"x-dynamic\": \"true\",\n              children: errorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-3\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"206\",\n              \"x-component\": \"div\",\n              \"x-id\": \"BarcodeScanner_206\",\n              \"x-dynamic\": \"false\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: startCamera,\n                variant: \"secondary\",\n                size: \"sm\",\n                className: \"gap-2\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"207\",\n                \"x-component\": \"Button\",\n                \"x-id\": \"BarcodeScanner_207\",\n                \"x-dynamic\": \"false\",\n                children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n                  className: \"h-4 w-4\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"208\",\n                  \"x-component\": \"RefreshCw\",\n                  \"x-id\": \"BarcodeScanner_208\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 21\n                }, this), \"Retry\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => {\n                  var _fileInputRef$current;\n                  return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n                },\n                variant: \"outline\",\n                size: \"sm\",\n                className: \"gap-2\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"211\",\n                \"x-component\": \"Button\",\n                \"x-id\": \"BarcodeScanner_211\",\n                \"x-dynamic\": \"false\",\n                children: [/*#__PURE__*/_jsxDEV(Upload, {\n                  className: \"h-4 w-4\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"212\",\n                  \"x-component\": \"Upload\",\n                  \"x-id\": \"BarcodeScanner_212\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 21\n                }, this), \"Upload Image\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              ref: videoRef,\n              className: \"w-full h-full object-cover\",\n              playsInline: true,\n              muted: true,\n              autoPlay: true,\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"220\",\n              \"x-component\": \"video\",\n              \"x-id\": \"BarcodeScanner_220\",\n              \"x-dynamic\": \"false\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n              ref: canvasRef,\n              className: \"hidden\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"229\",\n              \"x-component\": \"canvas\",\n              \"x-id\": \"BarcodeScanner_229\",\n              \"x-dynamic\": \"false\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 pointer-events-none flex items-center justify-center\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"232\",\n              \"x-component\": \"div\",\n              \"x-id\": \"BarcodeScanner_232\",\n              \"x-dynamic\": \"false\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative w-64 h-40 border-2 border-primary/50 rounded-lg\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"233\",\n                \"x-component\": \"div\",\n                \"x-id\": \"BarcodeScanner_233\",\n                \"x-dynamic\": \"true\",\n                children: [isScanning && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute inset-x-2 top-2 h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent animate-[scan_2s_ease-in-out_infinite]\",\n                  style: {\n                    animation: \"scan 2s ease-in-out infinite\"\n                  },\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"236\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_236\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -top-1 -left-1 w-6 h-6 border-t-4 border-l-4 border-primary rounded-tl-lg\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"244\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_244\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -top-1 -right-1 w-6 h-6 border-t-4 border-r-4 border-primary rounded-tr-lg\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"245\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_245\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -bottom-1 -left-1 w-6 h-6 border-b-4 border-l-4 border-primary rounded-bl-lg\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"246\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_246\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -bottom-1 -right-1 w-6 h-6 border-b-4 border-r-4 border-primary rounded-br-lg\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"247\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_247\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute bottom-4 left-4 right-4 flex justify-center\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"252\",\n              \"x-component\": \"div\",\n              \"x-id\": \"BarcodeScanner_252\",\n              \"x-dynamic\": \"false\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-black/70 backdrop-blur-sm rounded-full px-4 py-2 flex items-center gap-2\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"253\",\n                \"x-component\": \"div\",\n                \"x-id\": \"BarcodeScanner_253\",\n                \"x-dynamic\": \"false\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `w-2 h-2 rounded-full ${isScanning ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`,\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"254\",\n                  \"x-component\": \"div\",\n                  \"x-id\": \"BarcodeScanner_254\",\n                  \"x-dynamic\": \"false\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-white text-sm\",\n                  \"x-file-name\": \"BarcodeScanner\",\n                  \"x-line-number\": \"255\",\n                  \"x-component\": \"span\",\n                  \"x-id\": \"BarcodeScanner_255\",\n                  \"x-dynamic\": \"true\",\n                  children: isScanning ? \"Scanning...\" : \"Initializing...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 bg-muted/30\",\n          \"x-file-name\": \"BarcodeScanner\",\n          \"x-line-number\": \"265\",\n          \"x-component\": \"div\",\n          \"x-id\": \"BarcodeScanner_265\",\n          \"x-dynamic\": \"false\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            \"x-file-name\": \"BarcodeScanner\",\n            \"x-line-number\": \"266\",\n            \"x-component\": \"div\",\n            \"x-id\": \"BarcodeScanner_266\",\n            \"x-dynamic\": \"false\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-muted-foreground\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"267\",\n              \"x-component\": \"p\",\n              \"x-id\": \"BarcodeScanner_267\",\n              \"x-dynamic\": \"true\",\n              children: !('BarcodeDetector' in window) && \"Upload an image to scan\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              ref: fileInputRef,\n              type: \"file\",\n              accept: \"image/*\",\n              capture: \"environment\",\n              onChange: handleFileUpload,\n              className: \"hidden\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"270\",\n              \"x-component\": \"input\",\n              \"x-id\": \"BarcodeScanner_270\",\n              \"x-dynamic\": \"false\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outline\",\n              size: \"sm\",\n              onClick: () => {\n                var _fileInputRef$current2;\n                return (_fileInputRef$current2 = fileInputRef.current) === null || _fileInputRef$current2 === void 0 ? void 0 : _fileInputRef$current2.click();\n              },\n              className: \"gap-2 hover:bg-primary hover:text-primary-foreground transition-colors\",\n              \"data-testid\": \"upload-barcode\",\n              \"x-file-name\": \"BarcodeScanner\",\n              \"x-line-number\": \"278\",\n              \"x-component\": \"Button\",\n              \"x-id\": \"BarcodeScanner_278\",\n              \"x-dynamic\": \"false\",\n              children: [/*#__PURE__*/_jsxDEV(Upload, {\n                className: \"h-4 w-4\",\n                \"x-file-name\": \"BarcodeScanner\",\n                \"x-line-number\": \"285\",\n                \"x-component\": \"Upload\",\n                \"x-id\": \"BarcodeScanner_285\",\n                \"x-dynamic\": \"false\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this), \"Upload Image\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      \"x-file-name\": \"BarcodeScanner\",\n      \"x-line-number\": \"293\",\n      \"x-component\": \"style\",\n      \"x-id\": \"BarcodeScanner_293\",\n      \"x-dynamic\": \"true\",\n      children: `\n        @keyframes scan {\n          0%, 100% { transform: translateY(0); opacity: 0.5; }\n          50% { transform: translateY(140px); opacity: 1; }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 172,\n    columnNumber: 5\n  }, this);\n}\n_s(BarcodeScanner, \"qcHbBiZ3AKGfX9aFjmRO/BV/FSk=\");\n_c = BarcodeScanner;\nvar _c;\n$RefreshReg$(_c, \"BarcodeScanner\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Camera","X","Upload","RefreshCw","StopCircle","Play","Button","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","BarcodeScanner","onScan","onClose","_s","hasError","setHasError","errorMessage","setErrorMessage","isScanning","setIsScanning","stream","setStream","videoRef","canvasRef","fileInputRef","animationRef","detectorRef","window","current","BarcodeDetector","formats","startCamera","mediaStream","navigator","mediaDevices","getUserMedia","video","facingMode","ideal","width","height","srcObject","onloadedmetadata","play","startScanning","err","console","error","name","message","info","scanFrame","barcodes","detect","length","barcode","rawValue","success","stopCamera","requestAnimationFrame","cancelAnimationFrame","getTracks","forEach","track","stop","handleClose","handleFileUpload","e","_e$target$files","file","target","files","img","Image","src","URL","createObjectURL","Promise","resolve","reject","onload","onerror","detector","value","className","children","variant","size","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_fileInputRef$current","click","ref","playsInline","muted","autoPlay","style","animation","type","accept","capture","onChange","_fileInputRef$current2","_c","$RefreshReg$"],"sources":["/Users/utsavaggarwal/Documents/NutriDive/frontend/src/components/BarcodeScanner.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Camera, X, Upload, RefreshCw, StopCircle, Play } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { toast } from \"sonner\";\n\nexport default function BarcodeScanner({ onScan, onClose }) {\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [isScanning, setIsScanning] = useState(false);\n  const [stream, setStream] = useState(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const animationRef = useRef(null);\n  const detectorRef = useRef(null);\n\n  // Initialize barcode detector\n  useEffect(() => {\n    if ('BarcodeDetector' in window) {\n      detectorRef.current = new window.BarcodeDetector({\n        formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e', 'code_128', 'code_39', 'qr_code', 'itf']\n      });\n    }\n  }, []);\n\n  // Start camera\n  const startCamera = useCallback(async () => {\n    try {\n      setHasError(false);\n      setErrorMessage(\"\");\n      \n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: { ideal: \"environment\" },\n          width: { ideal: 1280 },\n          height: { ideal: 720 }\n        }\n      });\n      \n      setStream(mediaStream);\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = mediaStream;\n        videoRef.current.onloadedmetadata = () => {\n          videoRef.current.play();\n          setIsScanning(true);\n          startScanning();\n        };\n      }\n    } catch (err) {\n      console.error(\"Camera error:\", err);\n      setHasError(true);\n      if (err.name === \"NotAllowedError\") {\n        setErrorMessage(\"Camera access was denied. Please allow camera permissions in your browser settings.\");\n      } else if (err.name === \"NotFoundError\") {\n        setErrorMessage(\"No camera found on this device.\");\n      } else {\n        setErrorMessage(err.message || \"Could not access camera\");\n      }\n    }\n  }, []);\n\n  // Scan for barcodes\n  const startScanning = useCallback(() => {\n    if (!detectorRef.current) {\n      // Fallback message if BarcodeDetector not supported\n      toast.info(\"Live scanning not supported. Please upload a barcode image.\");\n      return;\n    }\n\n    const scanFrame = async () => {\n      if (!videoRef.current || !isScanning) return;\n      \n      try {\n        const barcodes = await detectorRef.current.detect(videoRef.current);\n        if (barcodes.length > 0) {\n          const barcode = barcodes[0].rawValue;\n          toast.success(`Barcode detected: ${barcode}`);\n          stopCamera();\n          onScan(barcode);\n          return;\n        }\n      } catch (err) {\n        // Ignore detection errors, continue scanning\n      }\n      \n      animationRef.current = requestAnimationFrame(scanFrame);\n    };\n    \n    scanFrame();\n  }, [isScanning, onScan]);\n\n  // Stop camera\n  const stopCamera = useCallback(() => {\n    setIsScanning(false);\n    \n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n    }\n    \n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n    \n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n  }, [stream]);\n\n  // Handle close\n  const handleClose = () => {\n    stopCamera();\n    onClose();\n  };\n\n  // Handle file upload\n  const handleFileUpload = async (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    try {\n      const img = new Image();\n      img.src = URL.createObjectURL(file);\n      \n      await new Promise((resolve, reject) => {\n        img.onload = resolve;\n        img.onerror = reject;\n      });\n\n      if ('BarcodeDetector' in window) {\n        const detector = new window.BarcodeDetector({\n          formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e', 'code_128', 'code_39', 'qr_code', 'itf']\n        });\n        \n        const barcodes = await detector.detect(img);\n        \n        if (barcodes.length > 0) {\n          toast.success(`Barcode detected: ${barcodes[0].rawValue}`);\n          handleClose();\n          onScan(barcodes[0].rawValue);\n          return;\n        }\n      }\n      \n      toast.error(\"Could not detect barcode in image. Please try a clearer image or enter manually.\");\n    } catch (error) {\n      console.error(\"File scan error:\", error);\n      toast.error(\"Failed to scan image. Please try again.\");\n    }\n    \n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  // Start camera on mount\n  useEffect(() => {\n    startCamera();\n    return () => stopCamera();\n  }, []);\n\n  // Restart scanning when isScanning changes\n  useEffect(() => {\n    if (isScanning && detectorRef.current) {\n      startScanning();\n    }\n  }, [isScanning, startScanning]);\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black/95 flex items-center justify-center p-4 animate-fade-in\">\n      <div className=\"relative w-full max-w-lg\">\n        {/* Close button */}\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"absolute -top-12 right-0 text-white hover:bg-white/20 transition-all\"\n          onClick={handleClose}\n          data-testid=\"close-scanner\"\n        >\n          <X className=\"h-6 w-6\" />\n        </Button>\n\n        <div className=\"bg-background rounded-2xl overflow-hidden shadow-2xl border border-border/50\">\n          {/* Header */}\n          <div className=\"p-4 border-b bg-gradient-to-r from-primary/10 to-secondary/10\">\n            <h3 className=\"font-heading font-semibold flex items-center gap-2\">\n              <Camera className=\"h-5 w-5 text-primary\" />\n              Scan Barcode\n            </h3>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              Point your camera at the barcode or upload an image\n            </p>\n          </div>\n\n          {/* Video/Error Area */}\n          <div className=\"relative aspect-video bg-black overflow-hidden\">\n            {hasError ? (\n              <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-gray-900 to-black text-white p-6 text-center\">\n                <div className=\"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mb-4\">\n                  <Camera className=\"h-10 w-10 text-red-400\" />\n                </div>\n                <p className=\"text-lg font-medium mb-2\">Camera Access Required</p>\n                <p className=\"text-sm text-gray-400 mb-6 max-w-xs\">{errorMessage}</p>\n                <div className=\"flex gap-3\">\n                  <Button onClick={startCamera} variant=\"secondary\" size=\"sm\" className=\"gap-2\">\n                    <RefreshCw className=\"h-4 w-4\" />\n                    Retry\n                  </Button>\n                  <Button onClick={() => fileInputRef.current?.click()} variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                    <Upload className=\"h-4 w-4\" />\n                    Upload Image\n                  </Button>\n                </div>\n              </div>\n            ) : (\n              <>\n                {/* Video element */}\n                <video\n                  ref={videoRef}\n                  className=\"w-full h-full object-cover\"\n                  playsInline\n                  muted\n                  autoPlay\n                />\n                \n                {/* Hidden canvas for processing */}\n                <canvas ref={canvasRef} className=\"hidden\" />\n                \n                {/* Scanner overlay */}\n                <div className=\"absolute inset-0 pointer-events-none flex items-center justify-center\">\n                  <div className=\"relative w-64 h-40 border-2 border-primary/50 rounded-lg\">\n                    {/* Scanning line animation */}\n                    {isScanning && (\n                      <div className=\"absolute inset-x-2 top-2 h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent animate-[scan_2s_ease-in-out_infinite]\" \n                        style={{\n                          animation: \"scan 2s ease-in-out infinite\"\n                        }}\n                      />\n                    )}\n                    \n                    {/* Corner brackets */}\n                    <div className=\"absolute -top-1 -left-1 w-6 h-6 border-t-4 border-l-4 border-primary rounded-tl-lg\" />\n                    <div className=\"absolute -top-1 -right-1 w-6 h-6 border-t-4 border-r-4 border-primary rounded-tr-lg\" />\n                    <div className=\"absolute -bottom-1 -left-1 w-6 h-6 border-b-4 border-l-4 border-primary rounded-bl-lg\" />\n                    <div className=\"absolute -bottom-1 -right-1 w-6 h-6 border-b-4 border-r-4 border-primary rounded-br-lg\" />\n                  </div>\n                </div>\n\n                {/* Status indicator */}\n                <div className=\"absolute bottom-4 left-4 right-4 flex justify-center\">\n                  <div className=\"bg-black/70 backdrop-blur-sm rounded-full px-4 py-2 flex items-center gap-2\">\n                    <div className={`w-2 h-2 rounded-full ${isScanning ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`} />\n                    <span className=\"text-white text-sm\">\n                      {isScanning ? \"Scanning...\" : \"Initializing...\"}\n                    </span>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"p-4 bg-muted/30\">\n            <div className=\"flex items-center justify-between\">\n              <p className=\"text-sm text-muted-foreground\">\n                {!('BarcodeDetector' in window) && \"Upload an image to scan\"}\n              </p>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                capture=\"environment\"\n                onChange={handleFileUpload}\n                className=\"hidden\"\n              />\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => fileInputRef.current?.click()}\n                className=\"gap-2 hover:bg-primary hover:text-primary-foreground transition-colors\"\n                data-testid=\"upload-barcode\"\n              >\n                <Upload className=\"h-4 w-4\" />\n                Upload Image\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <style>{`\n        @keyframes scan {\n          0%, 100% { transform: translateY(0); opacity: 0.5; }\n          50% { transform: translateY(140px); opacity: 1; }\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}